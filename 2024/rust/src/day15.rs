use array2d::Array2D;

#[aoc_generator(day15)]
fn input_generator(input: &str) -> Array2D<char> {
    let parts = input.split("\n\n").collect::<Vec<&str>>();
    // Split the input into lines
    let lines: Vec<&str> = parts[0].lines().collect();
    let moves: String = parts[1].lines().collect::<Vec<&str>>().join("");
    println!("{:?}", moves);

    // Calculate the dimensions
    let rows = lines.len();
    let cols = lines[0].len();

    // Collect all characters in row-major order
    let mut data = Vec::with_capacity(rows * cols);
    for line in &lines {
        for ch in line.chars() {
            data.push(ch);
        }
    }

    // Build an Array2D from the vector of chars
    Array2D::from_row_major(&data, rows, cols).unwrap()
}

fn current_position(grid: &Array2D<char>) -> (usize, usize) {
    for row in 0..grid.num_rows() {
        for col in 0..grid.num_columns() {
            if grid[(row, col)] == '@' {
                return (row, col);
            }
        }
    }
    panic!("No current position found");
}

fn move_to_offsets(m: char) -> (i32, i32) {
    match m {
        '^' => (-1, 0),
        'v' => (1, 0),
        '<' => (0, -1),
        '>' => (0, 1),
        _ => panic!("Invalid move: {}", m),
    }
}

fn do_move(grid: &mut Array2D<char>, m: char) {
    let (row, col) = current_position(grid);
    let (drow, dcol) = move_to_offsets(m);
    let (new_row, new_col) = (row as i32 + drow, col as i32 + dcol);
    if new_row < 0
        || new_row >= grid.num_rows() as i32
        || new_col < 0
        || new_col >= grid.num_columns() as i32
    {
        panic!("Invalid move: {} from ({}, {})", m, row, col);
    }
    // check if the new position is a wall
    match grid[(new_row as usize, new_col as usize)] {
        '#' => {
            return;
        }
        'O' => {
            let can_move_box = move_box(grid, &(new_row, new_col), (drow, dcol));
            if !can_move_box {
                return;
            }
        }
        _ => (),
    }
    grid[(row, col)] = '.';
    grid[(new_row as usize, new_col as usize)] = '@';
}

fn move_box(grid: &mut Array2D<char>, pos: &(i32, i32), offset: (i32, i32)) -> bool {
    let (new_row, new_col) = (pos.0 + offset.0, pos.1 + offset.1);
    // check if the new position is a wall
    match grid[(new_row as usize, new_col as usize)] {
        '#' => false,
        'O' => {
            if move_box(grid, &(new_row, new_col), offset) {
                grid[(pos.0 as usize, pos.1 as usize)] = '.';
                grid[(new_row as usize, new_col as usize)] = 'O';
                true
            } else {
                false
            }
        }
        _ => {
            grid[(pos.0 as usize, pos.1 as usize)] = '.';
            grid[(new_row as usize, new_col as usize)] = 'O';
            true
        }
    }
}

fn display_grid(grid: &Array2D<char>) {
    for row_iter in grid.rows_iter() {
        for element in row_iter {
            print!("{} ", element);
        }
        println!();
    }
}

fn simulate(grid: &mut Array2D<char>, moves: &str) {
    for m in moves.chars() {
        //clear the screen
        print!("\x1B[2J\x1B[1;1H");
        do_move(grid, m);
        display_grid(grid);
        std::thread::sleep(std::time::Duration::from_millis(30));
    }
}

fn calculate_sum(grid: &Array2D<char>) -> usize {
    let mut sum = 0;
    for (i, row_iter) in grid.rows_iter().enumerate() {
        for (j, element) in row_iter.enumerate() {
            if *element == 'O' {
                sum += i * 100 + j;
            }
        }
    }
    sum
}

#[aoc(day15, part1)]
fn part1(input: &Array2D<char>) -> i32 {
    //println!("{:?}", input[(2, 1)]);
    let mut grid = input.clone();
    //simulate(&mut grid, "<vv>^<v^>v>^vv^v>v<>v^v<v<^vv<<<^><<><>>v<vvv<>^v^>^<<<><<v<<<v^vv^v>^vvv<<^>^v^^><<>>><>^<<><^vv^^<>vvv<>><^^v>^>vv<>v<<<<v<^v>^<^^>>>^<v<v><>vv>v^v^<>><>>>><^^>vv>v<^^^>>v^v^<^^>v^^>v^<^v>v<>>v^v^<v>v^^<^^vv<<<v<^>>^^^^>>>v^<>vvv^><v<<<>^^^vv^<vvv>^>v<^^^^v<>^>vvvv><>>v^<<^^^^^^><^><>>><>^^<<^^v>>><^<v>^<vv>>v>>>^v><>^v><<<<v>>v<v<v>vvv>^<><<>^><^>><>^v<><^vvv<^^<><v<<<<<><^v<<<><<<^^<v<^^^><^>>^<v^><<<^>>^v<v^v<v^>^>>^v>vv>^<<^v<>><<><<v<<v><>v<^vv<<<>^^v^>^^>>><<^v>>v^v><^^>>^<>vv^<><^^>^^^<><vvvvv^v<v<<>^v<v>v<<^><<><<><<<^^<<<^<<>><<><^^^>^^<>^>v<>^^>vv<^v^v<vv>^<><v<^v>^^^>>>^^vvv^>vvv<>>>^<^>>>>>^<<^v>^vvv<>^<><<v>v^^>>><<^^<>>^v^<v^vv<>v^<<>^<^v^v><^<<<><<^<v><v<>vv>>v><v^<vv<>v^<<^");
    let moves = "^>v^^>vvvvv><vvv>vv>v^v<v<<<<><v>vvvvvv<^vv><v^v>><v<^><vv^^^<<<v>>v<<v^>v<<>v^^v>vv><^>><>v^>^^v<vv<<>vvv<^v<^vv><><vv<^^^v^><<vvv<<^>>^<<>^v>v^<^<^v>v>v>><v>vv^<^^>><<>^^v^<><^>^^<v^>><^v<><^v><<<v>^^>v^<^>>><^>^^^<<<v^><v<v>vv<^<v<^>v>>>vv<^<^>v<^><><<vv^v^<<^<>^>v<^v><vv><v>^^^^v^<><^^^^^v<vv<^<^^^^<v<vv<v<^vv<<^<v<<^^<<^><<<<vvvv<<>>^<<v<v^^>vv<^v^^^>><>^<^^><v^^vv^v<<^^^<<>v^>v>v<<^<>>>>><><v^<>^^><^<v>><<>><v^<v><<v<^v<<>vv<>^<>^>v>>^^^^v<<^vv><<<<^v^<>v<>v>v><>v<v<^vv^<^vvv>>^<><v^^>^>v<v>>v^>v^><^>^<^<>^>><<<<>^vv<<^>v>^<^><v<>>^>v<^<v^^>^><<v<^v^>>>>^v<><>vv<^>^^>vv<v^>vv^>v^^>^^v<>>v><^vvv<<<<><v<v^<^^^v^^<>>v<vv<<>v><>vvv^<^v^vv^>^>vv>>>^^<<<v<^><>v^^^<<>^<v<^>v>>>vv^<v<v^>^^vv<>v><<^^<>>v><><v<>vv^<^^vv>>^v^v<>^^<^>vvv<^>vv<^<^v>><^^^v><^>><^<^<<v<^<v<<^v>v<^v<^<<>^<<<><v^>>^^v>v<^<<>vv<v>^<vv<>v>v>v^vvv^<v<^<<>^<>v^^><^>v>v^^>>>>><<<<<<>^>><^<v^v<<v^^v>>^v<vvv><<<<vv>v<>v<>><<><^<v<>^><<^<vv>^><>vv^^>vv>>^vv^>^^v^<<v>>>^<v<<v>>vv^<>vvv^>^>>v^v^^^vv^vv^<vv^>v^^^<>v^<v<^>vv<v>>v^^v<><><vv^<vv<>^<^>v>v>^>^v^^>v<><^v>^^^<v^v>^<<vvv>>^<<>v><^<^^^<v><<v<^^^><<vvv>v^><<^<<>^^>^><>><^v<<<v<>^^^v<^<<vv<^vv<v^<^^v>v>^<^>^>>>^<^vv^><>^^v^>vv^v>^<<<vv<^>^<<^>>^^>vv<^<v>^v<^<v<vvv>vv^<<^<>vv<<>^v<^<<<<^v<>^>v><vv<^v^^v>>>><vvv<vvvvv>vv<v^<^^^<^vv>v<^v^^^<<^<^v^<^<^><^>^<<<>v<>v>v<^vv>>>v><<vv^>v>^^^v>><<^>^v><^>^v^>^><v<>><^<><^vv^<^<><^^vv^^><v^^><<^>^>>v^^>^^vvvv<><<>^vvvv^vv<^>^><<v^<><v<vv^>^^<^<v^^>^vv^v^><<v^^><<><^<<^vv^^<>>>^^^vv>v^<^<vvv>^v>^^v>>>><><>v^vv>v>vv<vv^vvv>vv^<^^v<<>^v<><>vvv^>>>^v>><vv<>v^v<>>>>^<^^<v>>^>^>v^>>v<>v^^^v<^vvv<><><<^<v<>^>>>^v<v>>>>^^><<<<<^^<^<^^>^<>vv>^>vv>v>^<><vv>>^v>v^^<<^>><^vv>v>^>^>^<<^v>^v<^<<>>v^>^v>v>v>><<<^^<^^^<<><>><<^<^^v^v^>v^^><v>>v>^<v^v>>vv^><v>v><>>>>>>>^^v<^>>>v<<><v<><^<>^v<^^<<^<^^vv>^v^^vv<<^vvvv><<<v><^^^^>>^<<><<>>vv>^^<<^><<<v<^><^^^<<>v^^^<<<vv>v<v>^<v>vv>v><vvv>vv^v^v<<v^^<v<>^^<><<<><v<^^^<vv<v>v>>>>v<^v<^^^>>^>^^<>^<<>^v^^><>>><<<<v^v>^^v>v<>>v<v>>v^v^<^<^><^<v><^^vv<^^<>v<><v>^v><^^<<>^<>^<<>^v^vv<><^^>><^<<<>>v<vv<>>^<<^<>v<<>>>^v>^<>v<^^>>v>^v>><^<<^><^<>v<>^v>><<<<<vv^v^>>>^^^>^<^>^>v^v<<v<>vv<^^<>>><vv>^><^^<<><>>^>v>^^>^<v<>^v>^><<^^>>vvv^<v^^>><><^<^>v^^v>>>>v^<>>v^^<v>^>><<>>>>>><<^^<><<vvv>vv^^v>v<^^vv>><>>^v<<>^v>^vv><^>^^vv>^v><>>>v^^<><^vvv>^^^<>v<>^v>>^vv<^<^<<><>vv<<^>>^^^<v><v<<><>^><>^v>^<>^<^>^>><^<>v^^<><^^<>v^<^v^<<<>v^<vv>>^>>^^^>>v>>>^^v><>>>><><^^<^v<<^v^^^<v>^v<><<v<v>>v^v><^<>>^<^v^^>>^>v<^<>>^^v>>vv^>^>^^><><v>^v<<^v^vv^vv^^>>>^^v><v>^<vv^><<<vvvvv>>^v><<<^><^<><<<>>^^^^>v>v^<^v^<v^<^vv<^^^v>>^v<^>v<^>>>^<^v^<<>vv^>><><v>v<v>>^>>>>v^<<>^><<^><^>^>><>^^v>><^^<^^vv><^v^<v<vvv><<v<>v^<><^>v<v^>>>vv^<<v^v<><<^v<><v>>v^v>^v^<v^<^^vv<<<>>>v<<<v^vv^v<><vv<><<>>^^<^>v><<v<^>vvv>^vv^vvv<<v^vv>^vv<>v<>v<v^<<<^vv>^^^^>^>>>><<<<^^<>>>^><^^><<<<<>v>^v><^><v<^<^v^><^^^<>>^^<vv<v^>>><^<>>^v>^<vv^v<^>>^<>>>v>>>>v^v^><vv^<<v<vv>^<v<>^^>v^>><>>^<<vvv^>^<>^<^<>>^^<<<<vv>>v>><vvvv>v^<^v<>^^v<<^v>>>^^<<>>vv><><>vv<^<v^<>^>vv>^<>vv>^vvv^v<>^<>vvv^v<vv<><^^v<vv<^>^><<v>><v>>^^^<v<v><<<^^^^>v<^^>v>v>v>>>v><<^^<^<v^<^>>>^^v>^><^v>>><><v^v><><v<<><v<>vv<>v><<>^v>^v<<^<<^<vv^v><>v^>v<><<v^<v>^^<><<v^v<^<>^<><>>^v^^^v>vvv<v^v^^><^><^v<>>>^<^>v><^<^^^^vv><vvv>v>^><^^v>v^v^v>><>^<v^v>>^v<^<>>><><>vv><>^<^^^^v^<^<<<>^><^<>>v<>^>v<^<^<^<v>^^v>vv>vv<^<<^<<^>vv><v<><<<^v>><^><<>v^>v>v^<<vv<vv<>>^vv^>v<>v^<v>v>^v>>>^<^^v^<<>vvv<vv><>^<><^^^v>v^^<^v>>vv>v^v>v^v>^<^^<<^>>><^^vvv^^>>^>>><^v><^^<>^>v<>>^v<^^vv>v<^>v>^<vv^v^^^^v<v<>vv<<>v^v>>vvv^<>v^vv^^^>v<>>^<^<^v>vv^^><^^>v<>vv<^vv^<<vvv^>v^v<<^<vv>v><>^^<^>vv>>^>><vv>^>^<v<^^>v^>v^^<>v>^>vvvvv>>>>^^><>>^<>vv<v<^^>vvv^^<v^^<^<v^v<vv^<>>^<^>>^^<v^<v^<<<>><v<><vv<^^><^vv>vv>>v^>^><>>v<<v^vv<v>>>^^<v><<>><><>^v<<^>v^<^^<v^^^v>>^>^<>^>>^>>^<vv^^<<v><>^>vvv><v<><<<<^v>>>^^>><^^^vv^^><<^v>><^><<v^<v>>v><<v>^>^v<><<<<^v<vv>v<^^^<^<>^>>>^><<<^<>><v^^<<<<<v>^>vv^v^^>^>>v><^<<>>v<^>vv>>><^^>vv>>^>^><<^v>>vv<v>vvv<>vv>v<><>>^>><><v<>>>v^><>^v^><^^<^>v>vv^>>v>^^v^<<^^^<<<<<<>v^v^^v><><v<^>v^><<vv^<vv<<>>^><>v<v>v<v<^vvv<>^>^<<v^>>v<>v>^<<^>v^v^>><vv<vv<><<v^vv><^<v<<^v>>>vvv>^<>vv>v<^><<>v^>v>v<^vv>^^v<vv>><<vvvvv<<v^v^<^<^>^v<vvv><><>^<<v<vv<^^^><^>^<v<v^>>^^^v>^>^<^^^<<vv^^^><^>v>>v>>v>>>^<v<^vv<^vv<>^><<^v^>^<><^>v<<>>v^>>vv<^^^^><^>v>>^>v<^>><^^vvv<v<v^v<<^^v^^>v<^v<vv^><<^<^v>^vvv>vv^>v<vv^^<<><v<<>>><v^<>^v<<<<<>v^>><>v>>^>^<^v<<<v<^>^<<^<<v>><><><>^>v^v<^^^<v^v>v>v>>v<>^^>^<<v^^<>>^<>^^><v>v^><<<>v<<<<^^^^^><>v<><v><>>vv^vvv>^<<^<>vv^>v>>><v>><<><>^<v<<v^>^^v>>^^<^>v><^<^<<v<v^<<>>v>vv<^>v>^<>^<^vv^^^^vvvv><<>^v>v<v<^^v^<><vv>^>^>>vvv<<v^v>^<^^>^>^v<>>^<v<v>v><>^>v^^>^<^<^<vvv^<<><v>^v<v^>>>>>^><^>v><>>^^>v>><^>^^vv<v>vv>^<^^vvv^>><v><^<^<<^<>v^<vvvvv<><<<^v^v^<v>>v^v>v<><v>^><v^v<^<<^<v<^^^><><<^<>v>^^^<v<<vv>><<v>^<v^<>v>>^^^^^><>vv^>>^^<>^v^^v><<<<^>v^<v<^><<v<>^<>^vv^<^<<<v^><v<<^<>v^^>>^<vv>^<<>^^<^>^v^><^<v^><><<^<v^v^^<^v><v<^^<v^^^^<v^>^<^<>><^>>^v><^<^v<^vv<<>^^v^v^<>v<<^vv><>^>^<v>^^^<v^<<^vv>>^<>^^^<v>^^^<v<><^>v^v^><<<^<^>^^v^>vv<^v^>>>vv>>^^^<v<v<^vvv^<^<>>>><>>^vv<>v^><>>^^<<v^<<>^<<>^vv^^^^^v<^>^>v<^<vv^<v>^<^<^<^v>v<v^^^>>v^>^^^<>>^><>v^>>>>^vvv^vv<<<>vv<<v<>vv<>^v<v>^<^><^^vvv<v<^>v^<<v<<<v^<v<<><^>^^<<>>>><^v><>^>v>vv<v<>>^><v^^^^^v<<^vv<^^^<v>^<<<<<>><<^vv><<^^<><<v<<^v^<><v<vv<v^>^v>>^<<^<><<<^<><v^v^>v><>v^v^v>^v<<<v<>v><>><^v<v^v^v^<v>vv<>>vv^>v^>><<^<v>v^>vvv^>v>vvv>^<v>v<>v<^>^<><^<v^><><v>><v^v>v>v^<>>^vv<>^><^^<^^^<>v>v^^<<><^v>^<v>>v><v<<v><>v>^v>^<v^>vv<>^v^>>>>>v>^>vv^^<v<>v^<>vv^vv>v<^v>^^^vv>>^^>^><>^v>>>^^^v>^v^<^v<<<<<<^^<v<^^<>^v^^><><^vvv^^v^^^^>>vvv<v^><vvv^v<><<v^<<<vv><<v<^^^vv^v<>>v<v<><^v>><<<<^<<^>vv<v<vv>v^v^v^^><<<^v^^<vvv^^>^>vvv>>^v>v^v<^<^<^<<^<>^>^v>^vv^^v>^^v<^>v><>v><<<^<>^^>vv^^<^vv^>^>><>>v^^>>^v<v>^^<>>>>><<>>^^v<^>v^vvv>><<>^>>><v^>v<>><v>^^vv<>>^v<<<<<<v>^v>^<><^^<>^^v^^^<^^<>v<>vv^^>>vv>><<vv>><v^<>^>^^^v>^><^^v^<<^<>>>^<>>>>^^^^v^^>v>v>v^>v>^<<<^><>v>^^>vv<^^<^>vv^<^vvvv<v<^^^><v>><^<^<<>v^>v^<v>^^<>^>>><>>^<^^^^<<^><<>vv>v^v>^^<vv<><v><v>>>vvv<<>^v<<^^>^v>^^>v>>>^^<v<>>vv<^<vv>v^<^>^^^v>^^>>v^^v^v^>>^^^>><<^>^^v<^>>^vv^^v<<^<<<^<^<vv^v<^vv>>v<>v<<v^v>>>>>vv<^v<<^>><v<<vvv<^^>>v>>^v<v<>>v^v<<>>^><vv^<^^^<^vv<>>>vv<^<<<^><>^^>><<>vvv^v<v<<^>^v>><^<v>^<<><>^^>>>>^^v<>^<^<v>v<vv<<^^>^^>>^v>>>>v>v<^<v>v>^>><<v^<>><<>^^<vv>v>^>^v<v><<v><>^^v<v<<>>v^^^<<><<<>vvv<v>v>>>>>>><vvvv><vv^v>>><<^<>><v^<v>vv<>v>^<<>><vv><<v>v>>><v<^<>>>>^^<>v<>^vv>>>>>^^vv><>v><<^<v<<^><v>^<<^^v<<><^>^^>v<<vv<<vv<^^^^<><^^^<^>^<>><^><^^<^><><^v<><v<^^v^>^^>>^vv>vv>v>^v<v^><^<<<^><^>>^>>>>v><>>^v<^<v><<v^><<^><>^vv<<>^<<^v<>^<v<<<<><>v>>><^v^<^^>>^^v^>v>>^vvvvv><<<<v><>vv<>^<v<>><<vv^<>>^vv^><v^<^v<<>^<v^>^^v>vv<v^v>><<^<>>^<><^<>^><<^^v>^^>v^^<^<v<><>vv>v<v^v<>v<^v^v^><v<vv>^^^v><^>><^<<<<^^><<vv>^<>>>^>>^v>>>^>><>^>>v^<^^>^v>vvv><^<v<<>vvv^<v^>>vvv<v>v<v^<<^<>v<v<><v^v<>>^^>>v>><^vvv>vvv<^<v^^v>><>>v>^<>>^<v<><>^<v^>v^<^v<<<<^v>>^<>>>^><><v>v>><>^^><vv><^v>><>^<v<<>v^<>^vv<<<>vvv><<>^<v^vvvvv<<^<vvv^^^^>^<<^><<^>>v<<<<^<<^^><^^v<^<^<>^>v^^^>v>^>><>><<v<^^<v<<v><^<^<>^^>>>><vv<>><<^>v<>>vv<v^^v>>>^>v^^<>^>>vv>v><>^^^><^><^^<<v<>^^vv>>^v^v<^^><>>^v<v><^^<^><v>v<><vv>>><><^v><>v^<><<v^<><^>>><^<>^<^^^<^v^^v^^^<<^>v>^<^^^<^^<^^^><<<<><<^^<<v^<<<^v^><>^^v><><^v<^<^^^><<^v>v>^^^>^^v>>^v<>v<><>v<>^^<vv^<vv^>^^^v<><>v>v<><<<^v<><>>>>^^v^v><v><^<^v^vv<><v^>v^<v>^><<vvvv>^><<v^<<>^<v>^v^<^<^>v>><v<><v>^vv<^<vv<^^>v<v>>v^^><^<>v<v><^^<v<>>v^v^^v^^><^^><<>v^>^^>vv>v>v>><^vv<<<^<<>v<v^v>>v<<v<><<<^^^v^<<vvvv<^>v^<><>v^v^>>v^<><v>vvv^v>^vv>><>>>v^^v>^<^>><>v>>v<vv>><^v>>^^v^<<^v<><><^^<v<v<^^^^<<v^>><>^^<<<v^v^>^>vv><^>^^v>^>^<vvv<<^v^<><vvvv>><v>v^>vv><><<<<<<>v^<<^>^><<^<v<v>v<^v^<<><>^^<v^<<^<^vv>vv<v<v><v>v^^<>vv<^><<>v><<<v>^^<^v^>>>v^<v<vv>>>^v>>v<<vv<<<<>^>^^<v>>v><^vvv><<<><^>^^<><^^v^<^<>v>^>v><>>>^v<<^<v><^v^<><>>^<<>^v^v<^<^^<vv^>v<^v^v^><>><>vvv>^<^>><v>^v^vv>><<vv^>^^^^v>v<><><<><<>^>v><<v>^<^vv<>^v^^>v^^^>^>>>>>>^<^<>v^^>v><^<<^<vv^><^^^><<vvvv<^^^<^vvv>^>vv>>>vvv<<>v^<vv<v^^^<^v^v^><v>v<<vv<>^^>vv>>vvvvv<^><v>><v<v>^^^^<^v<^>>^^vv^>^>>v^<<vv^>v^v>^><v>^<^<<^vv>^^vv>>v^^^<v><v<>^>>><^^<<>^^^<v<^vv>vv^<>v><<<^^>^>^><<>v<><>^<v<v>v>v<<>v><>>v^<>v<>v<<v^v<v>><^<^<v>><>><<v^^v^>^v^v<v^v^v^v^<^>vv>vv>vv>^^v>>v^^<vv<v^>>>vv<^v^>^v>v<v><<<<vv<><vv<v^<<<>v<>>v>>>^<<vv^vv^<v<v^><v<<^v^vvv^<<vv^<<>v<^>v^<<v<vv>v>>>>>v<vv<><v<<v<^<^<^v>v>^<v^<>v>v<<<v^<>>v><><>v<^^<v>><^v^<v^v<v><><>>v>^<>^^<<<v^>v>^><v<vvv^^v>^<>^<>^>^<v>^^^^^v>v>>>>v<><<vv^>^>>^>><vvv<v<<v>><<>>^vv>^v^<^>>>><<><<<<v<^^^>v<><vv>>v^^<v<v>v>><^>v>>>^v<<>vvv>>v><v<>>^><<^>v<>v<>^vv^>v^>vv><^<^^<v^><<v^^<^^^<^<^<><^^^v^^<v><^^>>vvvvv^v>vv^>^>^^><>^^><<<><<<v^^<<v^<<v^^<^><<^>v<<<>>^v>v^vv<^<v<>v<>^v<^^>v^^>^<<<^<><v>^^<>^>^<<<><v^>vvv<^><>vv>v><v<^^>>^v^^>^>>vvv<^<^<^vv<>><v^v^<v>^v^<v^><^<<>v><<v>^v^v>>^<vv^<>^vv>^>v>vvvvvv<^v^>vv>>^<><>>>><>^v<>>^vvv^^><<>><>^v<^><<>^v^>v>v^>>^^v^v^v<>v>>v<v^^<vvv>^><>>^^^^^^<>v>vvv>><>v>v<^<>v^v^<<^<>^^^<><<<^^>^^v<<>^v<^>>>v<>^>>v>v<<^^^><^>^v>>^v^v<><<^^^vv^v^vv^<>vv<v>^^v^^><v<^<><<^^^><v^<>^<<^<><^v^vv^v^>^<v<vv<>vv^v>>>v>v>^<vvvv^>><<<vv>v>^>><^<<vv^<>>^v^^<v<v>>vv>v>^v^>v><^^^^^<^^v>v^>^>vv^^<<><>>^v<<v<v>v<<><<<vv<v<<<vvv^^>^vv>>v<^v>v^v>v<v>vvvvv<><^v<>><^<<v>^>v<^>><vv>^>^>^v<^<^<^^><><v<^>>v>v<<<v<><>>v<^v>><vvv^<>^^<v^>vv><^>v<vv<v^><v><><^v<^v>v><<>vvv>v<<<vv^>^<>^>>>>><^<><><<^>^><^>^^vv>^<<^<v<vv<>vv<<^>^vv^^v<>vv<v^vvv^^<v><<v>^>v<^<<^v>>^^<>^v^^^^v^v^><>vv>vv<v>^^v<^><>>><>vvv^><<>><>v>^^vv<<vv><<v<vvvv><>v>v^v^v>><^^>v>^^><^>vv^v>vv><v^v>>>^^<>v<>v^vvvvv^v<^><>^^vv^<v^vv>^v<^<<>v>>^v>v^v>^^>^v^^<<^>><v<><<^vv>>v^>vv><v<<vv^<<^<vv>>v<^>>>><<>vv<<>v^>>vv>^<v><^<>^><^<>>^^^<>^v<><v>v>v>^<^^>>v^v<^v>><<>>v^>>^<<v>v<v><^^>vv^>v^<<<^v^>^><<<<v^>>v^vv<<^>v<vv>>v^<vv^v>v<<<v^v^vvvv<v^^^v^vvvv^v>>v<^><<^^v<<<<<<v^^<^^v>^>>>vv^><<^v^^<><^>^<<<<^<<^<<vvv>^^^><v^>v<><<><<^^v^>v^><>v<<v><><>>><<v>vvv<^>v<v^><^v^>v^>vv^<>^<^v^^vv><^^>v><<v><>>v^<^<v>^>^>v<^vv>^><<>v>>>^>>^<v<>^^^<^^v>>>vv<^<<vv<>^v^^<^^<<>v>>>^vvv>^^<vv^<v^<>^vv>^<v^vv>^v<^><v^>v>>v>v<vv^<^<>><vv>^v<^<v<>v>v>>v^>>v>^<v<^<>v>v^v^>v><v>v^>^^>v<<v>>>^v^<v^^>>^^^>>^vv<<^<>^>><<<>>^^<^v^<<vvvv^^v^<<<<<^^<^<^<>^v>vvv<^v<<v>^<^v<vv^^<vv>^^<>>^<v>>v><v>^v^^<<<>v>><^v^>>^>>><^>^v<>^<^vv><vv>v<v><^vv<^^<<v<^><vv^v<vv^v>^v^>>^>^^v^<>>v<<<<^<>v^>^vv^>^><v<v><v><>vvv<^<<>vv<vv<^>vv<v>vv><^v^v^^>v>v>^>^^<>>^vv^v<<v<>>>>^^>vv<<<<^^^><v>>^>>^<>>>>v>>^v<vvv^v<<>^^<^^>^>^v><v>^v>>^^^<<v<^vv^>v^<<v^v^<>v>>^v^^v>^v^>>v<>^<^^^>>^^^<^<><<^<v<<>>>v><>^^>>>^v^^<><^<>><v^^>vv<^>><<v^^^<>^<vv^><>>v<vv^^vvv<><><vv><^>^>><^>>v^vv<^v^>^v<>^vv<^<>^>v<>^^><<<>>v^^v^v<vv^^<<v^v^<>^^vvv<<v>^^>^vv<v^<>^^vv^^^^^>vv^^vv<^><v^<>>>^^^^><^^>^v<<>>>vv><<vv^>^<<v<v><<>^<>^<v>^v^^^>v<>^v>v><>^vv>v>^<v<<>v>>^<<>>vv>v>v>^v^^v^>vv>v<v<^v>>><<<>><<>^>>vv<><vv>^>vvv<^^><<^^^<v><^<v^>>>v^^>><><vv^^^v>vv><v<v^>^<^>v<>^v<vv>>v<^v>>><<<><v<<>^v<>>><vv<<<<>>v<^v^vv^^<<<v<>v<vvv<^<>^>^^><^v>>^vv>v>>>>>^><<<><vvvvv^<^<<^>><<<v^<<>v^<>>v<>^^><v^<^<v^v^<>>>>^v^v<v^v<v>^^v^>v>>v^<vv^^>^^^v<^<<^><v^^>^<v>>^v>^<^^<v^><v<^>^>^v>>^>^<>^vv^^>>>^<<<>^v<^<<v<>^^v>^>>^^^^<^^>^v><^><<v>v<v^v<^^^><v<<^>v<<^v^<^<<<v<>>v>>^<<>vv>v><<><>>><<v>>><>>vv^><^^<<v^v>vv<^><v^<<>vv>v<^>^^>^vvv<^<v^<><v<^^><^<^>>^^>>>vv>vvv^^><v<^<<v>^<>>^>vvvv<v>v>^^vvvv>>><^>v<<^^^>v<v<>^<^^>^<<><<v>v<^<<>^<v^>^vv<^>vv>^v<>vv<v<^^>v>v^^<^^vv<^>>^v^><<<>v>><^>v>^^v^<<<v><>^<vv^<<<^^^<<v<>>><<>vvv><v>^v<vv><><^>vv^>v^<>v^<<^v^vv>^v^<^<>^<><>vv^^<^v>>^v<v<<^>v<<v^>>v^^^<^v>v<>>^<v^<<v>v^v^^<^^<^<vv^^v<<<><<v^>>v^<<<^>>v^<<^vv^v^<>^>^vvvv^v>v^<>v<^vv<^>>v<<<<<v>>v><^vv>vvvvvv><v<<<^^^<<^v>v>v<<v<^^v^^^>>v^v<<^<v<<^<><<><<<v^^>><^>><>^><>^vvv<^<^v>v>v>^>^v^><^>v><>^^>v^<v^^>^<v<v^^v<^<v^v<>^>vvvv<v><>>^<>^>^>^<vv<><vv>>>v><v^<^<^<><^^^>>^>>>>>v^v^v^<vvvv<>><>^>v^^>>v^<v<v^^><><v^v>>v<^v^v^v^^^>v<v<<v>^^^v>vvv^<^^^>v<v<^><>>^><>vv^<>>^^>><^v<^^^><vvv><^<><^<><vv>v>^<<<>^<>><^vvv^>^<><v<^v^>>^^^^^<<<><<<vv^v^v^><>>>>v<^>^vv>vvvv<^v<<^vvv>v^>vv<><<v<v<^v<>v>>v<v^v>^>>>^v<vv^>>^^<>vv>v^vv<<v^^<v^v>vvv^v^<>^<<<v>>vvvvv^><^>><^v><><<><><><<>^>^^<v^<v>^vv>vv>v<>vv<>>><v>>><^>vv<<>^v^<v>>>^v<<v>^<>^^vvv<^^v^vv^^<^vv^>>^v^v>>vvv^<^>><v><>^v^>>>v<<<v^>v^v^<^<<>^vv^^^>>vvv^^<v^>vvv>><v^vvv<vv<^>^<><><<>^>^^v>^v^v^v<<><^<>>><^^<v<vv>v>^v<^^v<^vvvv<vv>^<^v^^>v<<<^v<>v>^v^^v^>v<>v>^^^<<>^vv><v<v^^<v>vv<>>>^<^^v^^>v<<><vvv>v><>v^<<<<vv><^>v^^<^<><>><<>><v^v^<<v>>>>^^>^^<<>^>^<>^><<^<<<<v^<^>v^^v><<>>^v^<<>><<<v><^>>^vv><>>v^v^^v><v<^^<<v^<v^v>^^^><>v^>>^>vv^v<v>v>^^v^>vv<>^><^v<>>^vvv>><>>v<>v>^vv<v<vv<^v>v><<>^v><<^^<<<<>^>><v^<>>^vv^^v>vv>^^<^^<^^><^>vvvv>>^<^v^^<>^v>^>>>^v^>>^v><v>>><<v<>>v^v>^vv<^<^v>v^^<><<<v>^<vvv<v>>><<>^<^<vv><^vv<<^<<>^>^v<<>^vv<>vv>v<vvv^^>^>v>v<v<v<>>><^^<<^>><^v^^<>>^^^v>^<v^^<<<v<^vvv>v^<>>><v<>^^v><>^^<^<>^<<v^v><<v>vv^<<<^^><v<><^<^^^><<v<v<<^><<>^<><>^^v^v>v^v>^<>^><>^^<vv^^vv<^^v^^<><<>v^<vvv<^>>v>>^>v<^^^<<<v<^<^><v><vv<v^>><v<^v^v>v^<^<>v^^v^<^^^>>v^>><^^<<v>>^><^>^v<vv^<v>v^vv<v>v^<<><>^<^<>>^v^v^^><v<v^>><<v^>>^v<v^>^v^>v^^>v^<<<<^v^<>v^>vvv^^>v>>>v^>^<vvv>^^<>v>v^vv<v<v<^>v<><><><<>><><>v^v>^^^<v^^>v>^<>^><><<><v>^v>><^<<vv<>vv>>v<<vv<>^^^>v^^v<vv>^v^v<v<><^<>>>^>v^^>^>^^^v>v>>v<<><>v^^<v<<<>^v<vv>^v<v<^><<<^<v>>^v<^>^>v<<>^^<^vv<<v>vvv>v^<<v>^><>^>>>^^^vv>v^>>^<^<>^^<><<>>>>^^^^>^><v>v^v<<vv<vv>^^><<v<<<<<<v<>vvv<^v^<^^vv>v<^v^>^^<<>>^<<^v^^v><>>v<>v>>><<>^>><^>v>^<^v>>><vvv^v<v><>><^<<v^<^^^^v<v^><>v>><>vv>v>^<<^>>>v<>^v<<><^v<><vvv<>v^^>v^<vv<^>>v<^v<>v^^><<^vv^<<<>^v>^>^<<^^<v<><<<<^^<v<<^>v>^^^<<><>^vvv<v<^>^v^^vvv^^>^^<v><^><v>v^<<^^><^v<<^<^^<^^^^>>^v<>^v>v>>^v>v<<v^<><>^^vvv><^>><^^<><v<v>>><^<<v><<v><v^v^^v>><><^>>>^>v>v>><<>v^v><<v^^^<>>>vv^<>^^v^>>>>^<v><>><<<v>><<>>v^<^>v^^><v^^v<<<^<^>^v>^vv^>v>^v^v^<^><><^vvvvv><>v<^<vv^vv^><^v><v>v^>>vvv><<<^^v>^^<>^^>^v^v<^^^<v<<><>>^>v<>^<vvvvv^<v^<>v<^<^^<>^^<><v<>v^^><>v<v>>v><<v<^v>^>>^^vvv<<^>^v^<^<^vvv^^^<^<v>^v<>vv<<v^<v>>>^^>>v<v^<<^<v^^^v^^>><v<v<vv^v<<v<><^^v>^<<vv>>^^<<^^vvv>^>>^<<^vv^v>v<vv<^<^^<<<>^>v<v<>v<>^<vv<v>>v><vvvv<<>>>><>^>vv^^vv><<>><<^v^>>v<<><v^v>>^>^<v><><>>vv>v^><<^>^>><^^<v^^<vv<<><<v^<^^>^v<v>v^vv^^^<v>v^><>v^>v>v^v>><v>vv<>^>^<v<><v<>>v<>><<>^v^^^><><>>>^>vvv>^^<>v<v<v<^^^>>>>^>v>>v><<<^>>>^v<<^>>>>>><>>vv^v<<<>><^<^v^>vv<>v<>^^^^>><>><<>^v<<v>v<vvv^vv^<v^^^^^^^<>v<<^vv>v>^v>>^v^vv<>v>^>>>^v^v>><<<><>^<^<>>^^^v<v>^vv>^<><>><>v><v^><<^vv<>vv>v><<>^^v<>^>v<^^^^>>>^>>^^^>>v><>vvvv>>^<<v>v^^v^<vv>v<<<>v^<<vv>><>vv^^>>>^^><v^^^v^^>^^v^^^v^^><<^^><<v^<<v>^v<<^^vv<<^>v<><>v<^v>>><<<^v>>^v>v>^>^v^vv^><<<^^^vv^v^v>><^>><^>^^>v<^<v^^^<v>^v<<>v<>>><v>>v<<<v<vv>v>>v<<>>v<vv^vv>vvv>v^>v<<^^<vv>>v<^^><v<vv><^v<^<>v^<<>>^>^<<<<v<>v>v>><<^v<<>vvvv^v^>v>^<^>^>v^v>^<>>v^^<v>vv>v<^>^^<vv^<<<><<vv>^<<^^v^v<>><vv<<^<vv^<><^^>v^<><>v<>v><^>^><<v^<<^^>v>v^^v^<vv>vv^^v^v<<vv^vv><^<><^>v<v^v><>>vv<^>>^v<<<>><>><^><v>vv<<>vv^^vv<^>><v^^><vvv^^<>>>>v^v><<^vvv^v<v>vv^vv<^^<^>>>^<><<<v>^<vv^^v^v><vvv>vv>>>><^<v<>^vv^^<>>v>^^<<^<^^>>>v<<<>^<>^v^>v<^<<>^v<>>v<vv<v<<vv^>^^<^<>>vv<<vv^v^>><^^<v^v>^v^<v^<>><<^<>^>><>v^^><vv<<v^>v^<<v^>^v<<v>><vv^vv><^^<<v>>>v^v^>^<<v>v^<^^v^<v><>><>v<v<>^<v>v^<<^>v<<v>>><>>^><<^<<v>^^<v>^>^><>>>^vv<<^v>vv<>^^<^vvv<>>>>v>v^<<><>>>>>>^vv<>v<v>><^<vv><>v<^v>^v^v<vv^<<><v>>vv<>^<<<v^v<^vv>v>^<^v<>><v<v>>>v>v^>v^>v<<>v<^<><^><v<v<^v^<<v><vvv<<^^^<^v>>>^^^^<<<^v>^>^<^^>v^><>v<vv><v<<>^^^>vv^v^>^v<^<<<>v<v^vv<>>><^<<^<v^^<^^>>>v<<<^<^v>vv^>^v^vv>^^^^^v><^>v>^<<<<^<v>^^<<^<^><>vvv<>^v>vv>^v>^>>^<^>>^^>^v^><><vvv<<<^^><^>^^<v<<v<v^<^<vv^vvv<^>^^^<v^v^v<v^>^><^^^v<v^^<<<<v^<<<<^<<^<>v>v<<v><<>vvv<v>>><<><>^v>^v><^v^v^<<^>^>v<v<^^^<><v^>^^>v<v>v<>^^^v>^>>v^><^><^vv<^^^<vv<v^vvv>v<>v><<v^<v<>v>>v^<<v>^v^>^v^v<v>^^v<^<>><^>^>vvvv><v^^^v>>^v^>^<>v>^>^>^^<^<>>>v>^>><>><><<<>>>>vvv^<<>vv<v<<v<v^<^>>v>><><>^vv>>><<>^>>v^>^vv<v^<^^>>v<v>>vv<^<><<><<<><><^<>v<>^^<<><vv^<^>>v><<<>v^>v<v<<^<>^v<^>>^>>vvv<<vvv^<<^>>^^v><vvv^^<>>^v<>^<^v^vv>v<<v>v^^<^vv>vvv^><vv<>v^^<vv^>v<<>>^^<>^vv^^<><<<<<>v^^<><v><^>vv<^><>^>>^<^<^^<<><<>^v>vv<>><<>^<<>>^vv^v>v<v^^^v>^v^>v><v>^v><>^^^<v^<>v>>>^<<<^<>v<^>^v<>^vvv><>>vv^<^^<<v^v^<^^vv^<>>^<vvv^^^<vv><v<v><^^<^<^<<><<v<vv<^^^^<>v>^<v<vvv^^^<<v^>^v>>>^>^^^<v<^^>>>^<<<<<<^><v<^v<^v<^<>vv<>>vvvvv>^^<vv^><>^v^>^v^>^>v^>^^v>v^vvvvvv^<v><^^<<>vv><>vv<>vv<vv<v>^>^>v^>>><^<^<^^^<<>v><v<^^><<<vv>^><><v<>><v>^^v^<>>^<v>><^<^<<v<v^><<><^>v^^^><<^vv^<<^^<<>v^<^v>v<v^<>v>^><^><<<^v>v<<v<<v>v>>>^><>v<><>v^>v^v>>^v<v^v^<<<<<vv>v<>v>^v<>^v<>>><><^><^>>^^v><^>^>>^^>v>>><^>vvv^<>v><v<<<>v<<^^<>v><<><^v<>>^<v>><vv<vv><>v<^vvv^<^v>^<^><^<v>v<^v^v^^vv^v><vv>^<^<^><<^<v>v<vv><v^^><^<<><<^^v^<v^><^^<><<^<>v>v>>^v<^^<v^v^vv<v>><^vv^v>>^<^^v<v<<>v<^v>^<^><^^>v<>^>v>>v>>>v^>^<vv<v>v^v^<^^<><<<<>^<^vvv>^<vv>v^^>^v^<<>^^>vv><<>>^v><>^v^<<<>v>>^<v>>>^<v>^v>>^<><v>vv^v>>^<><^^>v<v^^><>>^>^>^v><>><v<<>^v^<>><v<<^>><<>^^>>v<<><<^<^<^^<v<^<^v<><^v>v^^^v^<v^^^>v>>^v<^^^>^><vv^>>v<^>v>^^^^>^v^<<>v<^>^><^^^>^>v<^v>>^^>vv<v><<v><^^^v^>>^^>^<v>^>^v<>^<<^^<vv^>><>>>v<<^^>vv^^v><v^^>>v<v<^><vv<v<>^<^<v^v^<><^^<v<><><<vv<^<<><^^<^v^<>v>><vv^<><v<v^>>v^v<v<^v^<<<><v>>v>><vvv<<>^>^vv<><<v^v>^^><<><<v>vv<<<^vvv>v^<><^v<<^<v><<<>><<^>^vvv>vv^v>^^^>v^^>^v>>^^><^v><^v>>^><^>v<><<v><^v<<><<<^^^^>^>v>^^v^^v>>>v^^<<^^>v><^>^<>^^>vv>v^><^<^>^>>>^<v<><^vvv^<>vv<^^<v>><^>>v<v>vv^<v<v<><v><>v^><<^>v>>><<vv<<<v^<<>^vv>>^<^^<<<v^^v^^vv>v>^<^>v><<v><^>^v>^v<v>v^v<>>v<>v><>^<<>>^<<<>>^><<<v><>^<vv<>^v<v<<<<>^^<vvvv^>^vvv^><<<><vvv<^^v>v<<<^<<v<><<<vv^<<^<^<v>>>^<>^>>^v>><><v<<>^<^^v^^>>>v>v>^^><>^<<vv>>>v^^v^>>>>>^>v<<>vv^>^>^^^<>>>><v<><><<^vv<v>^v>>^^>^<>>^^^v^><^<><>v>v<^<^<v<>v<><v><v^<vv><^^<>v>v>^^<>>^^><>>v^^<<<v<<>v^v<^<>>v<v>v^<^>>>v>vv<><<<<^><^<^^^<^^^^^^<^^>v<>v<v<>^<><>v>v^<>>>>v^vv>^vvv>vv>>v^>>>>vvvv>^^v^<<^^>>v>>v>^<>><<><v>>^<^v^<v>^<^v>^v^<v<<<>><<v>^>v^^^v^vv>>v<><<>^>v<>v<<>^^><v<vv<<>v><v>^v<v><v^<^^>v>v<^^<^>v^^<^v>>><<>>^^vvvv^vv^<>v><<<><>><>>v<>>>vv>vv<>vv<^>>^<<<><<<v>^>>>v<^<>^vv^^v><>v><>v^>v<^^<<v><^^<v>^v><<><<<>^>v<v<><v>>><>v^<^><^^v^v^^>v<>^^^^v^^v>>>v^<<^<<^vvv<<^vv>vv><<>^^v^vvv<^>>v^>^>v>>><>vv>v>>^^<vv^>v<v>^<<<v^<>^v>^v<v>^<v>vvv<>^v^^^<>v>^<vv^v<^<vvv^<<^>^<>>^>><^<><>>^><><v>^v<^<<v>><^vv><v<>^<><^>^<<>^<vv^v><><>^><>v>^<^<<<^>^<v^><<^<<<vv<<v><^v>^vvvvv<^<vv<vv<>^v<v<v<v^<v<^v>><v><^<<^^^^>^><<^<v^v^v<^v^vv^v<>^^^^v^<^<<><<<>><vv^^>^v<^v>>><^>>v>>><<v^<v^<vv^^<>^>^^^v<v>>>^v<v^^^<^><^>v^vv^>>^v>vv^<>^^v^^vvv>><^<^><v>>vvv^>^^>vv<^v>^v><>^>>v<^vvv>v^v>^<^^>>v>>><<<<>v>^v><<^v^<v<>^^^<^v>^>v<>>v>vv^<^^>^>v^^v<<>>><^>v^^vv^>^v>vv<^><<^^vv<v>^v<>^v^<v<>^vv^v<^^vvv>^<>v><vvv><v^v^>>>^<<>v^vv>^v><v>^^><<>^><^>><>><>vvv^^v<v^^^v^^<v<<<>^^<v^>>>vv<v^><^>vvv^>><vv^vv^^>>^>>^<^>><<>^v>^<>vv>^v>><v^v^v>>><<vv^>>v<^^>vv>><>^^^>^<^<<v^vvv<>><^<<v<^v>v><v^^<<v^v>^v^<>^^<><>^v^<>v^v^vv>>>v<<^>>>>^<>^v<^<^^v><<>^v^v^^vv^<<^<>v>>^>>>>^^^>^^>vv>>^v^<v<>^><v>>>v^v>v>><^v^^^<^<^^<><>v<<<vv>>^v<v^>^^<>>><^v<^v>>^<^>><<^v<<v>v<><>v^><vvv>><>^<v>>>^^<<v^><>^>^><^v>v<v^v^<v>><v<v^^>^^>>><<<vv^^^>>^>>^^^^<<v^<<>v><>>v^^<<v><^^v><<>^>vv>>^<<^<^>>^>>v^>vv<>><^v<vvv^^v>^v>vv<^<>><v><<<<vv^>>^v<^<v^>^<><<^>>v<v^v<^^>v>vv>v<<>^^^v^^^>>><^<v^^<v><<^>><v><>^^<<^v^v<>^v<<v<>>><vvv>>^^v<^vv>v>v>>><><^^^v^<^^<^vv<^^><v^><<^^vvv^^>>^><>>^^<vv^^vvv>>^>^^>>><><v^<<>>>vv^vvvvv<<>^^<<vv<>^vvv^>v^^^^>v^vv<<<v^>^v^>^^<v>v<>^v<v><^>vv>^^^<><^v^>>^<>v^v<^>vv^^^>^<^<><<^>^>>v><<<vv>v>><<v^><v^^<^v^<<v><<^<^<><^><>vv>^^^<v<>>v<><>^^^>^v>>><>>^<>v^^v<v^<<v<vv^^v<v>^>v<v^>v>^^^<>^<v>><^><vv>>>>>>>^v><v<^^^><<>>v<^<v<^<>v<vv<^<^^^^<^v<>v<v<^>v>v><>><^><>^<v<^>^^^^<^<>v^>>^^^>v^^><>>^>^>><<^><^>>^<v^^v^<><v<>v>>><<<>v<^^>v><<v^^v^<>>v>><v<^v>><>^^>>^^^<>><<>v<^^>^^^^>>>><<v><>>><<^<>>v>>^v^<><>><><^^v^vv^>^<^^<<^<<^^<v^>^<^v>^<^>^<>^<<<v^<>vv><<>^vv><<<>v><<^vv<^>vvv>^^^^>>^<<>v>>v^>v<^v^<><>^><<v>v><>^v>^<><>v<>>>v>>>^^^^v<^>>><><vv><^^<<<>^>>>v>^>^>^<>v<<v<<v<^<<><^^<vvvv>>v><v^v^v^vv^v><v>^><><>vv^v^<^vvv<><v>>v<v<<^^vv^>v^v>vvv^v>><<v^>v><>^v<>v>^^<v^v<v>vv^^>>>><^v<<<<v^v<v^<>>>vvvv^^<v^<vv<<v<v^><>>>><<vv<><>>>vv^^>>^>^<v<><^>^<vvvv^^>>^v^<^>^^<v<v>><v>vvv>^v>v><>v^v>>vv>><^<<v<>^v<^vv^^v>v^>v><><vv><^<<<v^<>>><vv^<>v><<v>^^<v<<<<^v^<^v><>v^<v><><>>^>vv>>^>v<v<>>^><vv^>>^^<<<><^^v>v>>>v^v>^vv^><><>>vv>>>vv><^^<>^>^vv<^^>^^>>>><<^<v>v><><^v>v^vvv>>>>v^>v>>>>>v^>^^v^<<vv^<<>>v<>>v<^v>^<vv>v^>vv<>^>>>^v<<vvv>>^<^^v^v<^>><vv<>>v>><>v<v>v>^<^^^>^><>vv>^<>^v>^<<v><>><<>>>v<^v^^";
    for m in moves.chars() {
        do_move(&mut grid, m);
    }

    calculate_sum(&grid) as i32
}
